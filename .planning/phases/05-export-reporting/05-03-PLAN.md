---
phase: 05-export-reporting
plan: 03
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - src/export/formatters/css-vars.ts
  - src/export/formatters/tailwind.ts
  - src/export/formatters/figma-tokens.ts
autonomous: true

must_haves:
  truths:
    - "CSS custom properties file contains all token types under :root with semantic names"
    - "Tailwind v3 JS config extends theme with colors, fontSize, spacing, borderRadius, boxShadow"
    - "Figma tokens file uses W3C DTCG format with $type and $value per token"
    - "All three formats use identical semantic token names from shared naming module"
  artifacts:
    - path: "src/export/formatters/css-vars.ts"
      provides: "CSS custom properties generation"
      exports: ["generateCSSCustomProperties"]
    - path: "src/export/formatters/tailwind.ts"
      provides: "Tailwind v3 config generation"
      exports: ["generateTailwindConfig"]
    - path: "src/export/formatters/figma-tokens.ts"
      provides: "Figma tokens plugin format generation"
      exports: ["generateFigmaTokens"]
  key_links:
    - from: "src/export/formatters/css-vars.ts"
      to: "src/export/semantic-namer.ts"
      via: "Shared semantic naming for CSS variable names"
      pattern: "import.*generateSemantic"
    - from: "src/export/formatters/tailwind.ts"
      to: "src/export/semantic-namer.ts"
      via: "Same semantic names as theme keys"
      pattern: "import.*generateSemantic"
    - from: "src/export/formatters/figma-tokens.ts"
      to: "src/export/semantic-namer.ts"
      via: "Same semantic names as token keys"
      pattern: "import.*generateSemantic"
---

<objective>
Create three export format generators: CSS custom properties, Tailwind v3 config, and Figma tokens plugin format.

Purpose: Per user decision, all three formats are generated by default with no config needed. CSS custom properties is the primary format (lowest friction). Tailwind v3 JS config for broader compatibility. Figma tokens use W3C DTCG format. All share the same semantic naming from 05-01.

Output: Three format-specific modules in `src/export/formatters/`.
</objective>

<execution_context>
@C:/Users/Karl/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Karl/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-export-reporting/05-RESEARCH.md
@.planning/phases/05-export-reporting/05-CONTEXT.md
@.planning/phases/05-export-reporting/05-01-SUMMARY.md
@src/types/normalized-tokens.ts
@src/types/tokens.ts
@src/output/dtcg-formatter.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CSS custom properties generator</name>
  <files>
    src/export/formatters/css-vars.ts
  </files>
  <action>
Create `src/export/formatters/css-vars.ts`:

`generateCSSCustomProperties(result: NormalizationResult): string`

Generate a complete CSS file with `:root` block containing all design tokens as custom properties.

**Structure:**
```css
/**
 * Design Tokens - CSS Custom Properties
 * Generated: [ISO timestamp]
 * Source: UIUX-Mirror design DNA extraction
 * Do not edit manually - regenerate from source
 */

:root {
  /* Colors */
  --color-primary: #3b82f6;
  ...

  /* Typography */
  --heading-1-family: "Inter", sans-serif;
  --heading-1-size: 32px;
  --heading-1-weight: 700;
  --heading-1-line-height: 1.2;
  ...

  /* Spacing */
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  ...

  /* Border Radius */
  --radius-sm: 4px;
  ...

  /* Shadows */
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.1);
  ...

  /* Motion */
  --duration-1: 200ms;
  --easing-1: cubic-bezier(0.4, 0, 0.2, 1);
  ...
}
```

**Implementation details:**
- Use semantic names from `generateSemanticColorName`, `generateSemanticTypographyName`, `generateSemanticSpacingName`, `generateRadiusName`, `generateShadowName`, `generateMotionName` (all from semantic-namer.ts).
- Sort tokens consistently: colors by occurrence descending, typography by size descending, spacing by value ascending.
- For typography: emit separate vars for family, size, weight, line-height, letter-spacing (each gets own custom property).
- For shadows: reconstruct CSS shadow shorthand from ShadowLayer properties (`offsetX offsetY blur spread color`). Handle multi-layer shadows with comma separation.
- For motion: emit separate duration and easing properties.
- Comment each section for readability.
- Return the full CSS string.
  </action>
  <verify>
    - `npx tsc --noEmit --skipLibCheck` passes (0 errors)
    - Function signature accepts NormalizationResult and returns string
  </verify>
  <done>
    - generateCSSCustomProperties produces :root CSS block with all token types
    - Semantic names used for all CSS variable names
    - Shadow values reconstructed as CSS shorthand
    - Typography split into individual properties (family, size, weight, line-height)
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Tailwind config and Figma tokens generators, update barrel</name>
  <files>
    src/export/formatters/tailwind.ts
    src/export/formatters/figma-tokens.ts
    src/export/formatters/index.ts
    src/export/index.ts
  </files>
  <action>
1. Create `src/export/formatters/tailwind.ts`:

`generateTailwindConfig(result: NormalizationResult): string`

Generate a Tailwind v3 JavaScript config file (per research: v3 for broader compatibility).

**Output structure:**
```javascript
/** @type {import('tailwindcss').Config} */
module.exports = {
  theme: {
    extend: {
      colors: {
        'primary': '#3b82f6',
        'secondary': '#10b981',
        ...
      },
      fontSize: {
        'heading-1': ['32px', { lineHeight: '1.2', fontWeight: '700' }],
        ...
      },
      spacing: {
        'xs': '4px',
        'sm': '8px',
        ...
      },
      borderRadius: {
        'sm': '4px',
        ...
      },
      boxShadow: {
        'sm': '0 1px 2px rgba(0,0,0,0.1)',
        ...
      },
    },
  },
}
```

- Use semantic names but strip the type prefix for Tailwind (e.g., "color-primary" -> "primary" in colors section, "spacing-xs" -> "xs" in spacing section).
- For fontSize: use Tailwind's extended format `[size, { lineHeight, fontWeight, letterSpacing }]`.
- Generate as `module.exports = ` (CommonJS) with `/** @type {import('tailwindcss').Config} */` JSDoc comment.
- Use `JSON.stringify` with 2-space indent for the config object, then wrap in module.exports.

2. Create `src/export/formatters/figma-tokens.ts`:

`generateFigmaTokens(result: NormalizationResult): string`

Generate Figma tokens plugin format (W3C DTCG compatible).

**Output structure:**
```json
{
  "color": {
    "primary": { "$type": "color", "$value": "#3b82f6", "$description": "..." },
    ...
  },
  "typography": {
    "heading-1": { "$type": "typography", "$value": { "fontFamily": "...", "fontSize": "...", "fontWeight": 700, "lineHeight": "..." } },
    ...
  },
  "spacing": { ... },
  "borderRadius": { ... },
  "boxShadow": { ... },
  "motion": { ... }
}
```

- Uses W3C DTCG format with `$type` and `$value` (reuse patterns from existing `src/output/dtcg-formatter.ts`).
- Add `$description` with occurrence/page count info from evidence.
- Group tokens by type at top level.
- Use semantic names (strip type prefix within their group for cleaner Figma display).
- Return `JSON.stringify(figmaTokens, null, 2)`.

3. Update `src/export/formatters/index.ts`:
   - Add re-exports for generateCSSCustomProperties, generateTailwindConfig, generateFigmaTokens

4. Update `src/export/index.ts`:
   - Ensure formatters barrel is re-exported (should already be from 05-02 plan, but verify)
  </action>
  <verify>
    - `npx tsc --noEmit --skipLibCheck` passes (0 errors)
    - All three format generators exported from src/export/index.ts
  </verify>
  <done>
    - generateTailwindConfig produces valid Tailwind v3 module.exports config
    - generateFigmaTokens produces W3C DTCG formatted JSON
    - All three formatters use semantic naming from shared module
    - Formatters barrel updated with all exports
  </done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit --skipLibCheck` â€” Zero TypeScript errors
- CSS vars generator produces `:root { ... }` block
- Tailwind config produces `module.exports = { theme: { extend: { ... } } }`
- Figma tokens produces valid JSON with `$type` and `$value`
- All three use identical semantic token names (via shared semantic-namer)
</verification>

<success_criteria>
- CSS file has section comments and all 6 token groups (colors, typography, spacing, radii, shadows, motion)
- Tailwind strips type prefix for Tailwind-native naming (colors.primary not colors.color-primary)
- Figma tokens include $description with evidence-based descriptions
- All three formats produce parseable output (valid CSS, valid JS, valid JSON)
</success_criteria>

<output>
After completion, create `.planning/phases/05-export-reporting/05-03-SUMMARY.md`
</output>
